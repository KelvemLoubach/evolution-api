{"version":3,"sources":["../../src/utils/sendTelemetry.ts"],"sourcesContent":["import axios from 'axios';\r\nimport fs from 'fs';\r\n\r\nconst packageJson = JSON.parse(fs.readFileSync('./package.json', 'utf8'));\r\n\r\nexport interface TelemetryData {\r\n  route: string;\r\n  apiVersion: string;\r\n  timestamp: Date;\r\n}\r\n\r\nexport const sendTelemetry = async (route: string): Promise<void> => {\r\n  const enabled = process.env.TELEMETRY_ENABLED === undefined || process.env.TELEMETRY_ENABLED === 'true';\r\n\r\n  if (!enabled) {\r\n    return;\r\n  }\r\n\r\n  if (route === '/') {\r\n    return;\r\n  }\r\n\r\n  const telemetry: TelemetryData = {\r\n    route,\r\n    apiVersion: `${packageJson.version}`,\r\n    timestamp: new Date(),\r\n  };\r\n\r\n  const url =\r\n    process.env.TELEMETRY_URL && process.env.TELEMETRY_URL !== ''\r\n      ? process.env.TELEMETRY_URL\r\n      : 'https://log.evolution-api.com/telemetry';\r\n\r\n  axios\r\n    .post(url, telemetry)\r\n    .then(() => {})\r\n    .catch(() => {});\r\n};\r\n"],"mappings":"6iBAAA,IAAAA,EAAA,GAAAC,EAAAD,EAAA,mBAAAE,IAAA,eAAAC,EAAAH,GAAA,IAAAI,EAAkB,oBAClBC,EAAe,iBAETC,EAAc,KAAK,MAAM,EAAAC,QAAG,aAAa,iBAAkB,MAAM,CAAC,EAQ3DL,EAAgB,MAAOM,GAAiC,CAOnE,GAJI,EAFY,QAAQ,IAAI,oBAAsB,QAAa,QAAQ,IAAI,oBAAsB,SAM7FA,IAAU,IACZ,OAGF,IAAMC,EAA2B,CAC/B,MAAAD,EACA,WAAY,GAAGF,EAAY,OAAO,GAClC,UAAW,IAAI,IACjB,EAEMI,EACJ,QAAQ,IAAI,eAAiB,QAAQ,IAAI,gBAAkB,GACvD,QAAQ,IAAI,cACZ,0CAEN,EAAAC,QACG,KAAKD,EAAKD,CAAS,EACnB,KAAK,IAAM,CAAC,CAAC,EACb,MAAM,IAAM,CAAC,CAAC,CACnB","names":["sendTelemetry_exports","__export","sendTelemetry","__toCommonJS","import_axios","import_fs","packageJson","fs","route","telemetry","url","axios"]}